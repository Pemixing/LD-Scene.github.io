<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="LD-Scene: LLM-Guided Diffusion for Controllable Generation of Adversarial Safety-Critical Driving Scenarios">
  <meta name="keywords" content="Large Language Models; Diffusion models; Traffic simulation; Generative AI; Intelligent Transportation System">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LD-Scene: LLM-Guided Diffusion for Controllable Generation of Adversarial Safety-Critical Driving Scenarios</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" type="image/svg+xml" href="./static/images/favicon.svg" />
  <link rel="icon" type="image/png" href="./static/images/favicon.png" />
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({startOnLoad:true});</script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
</nav>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">LD-Scene: LLM-Guided Diffusion for Controllable Generation of Adversarial Safety-Critical Driving Scenarios</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="">Mingxing Peng</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="">Yuting Xie</a><sup>2</sup>,</span>   
            <span class="author-block">
              <a href="">Xusen Guo</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="">Ruoyu Yao</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="">Hai Yang</a><sup>1,3</sup>,</span>
            <span class="author-block">
              <a href="">Jun Ma</a><sup>1,3</sup></span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>The Hong Kong University of Science and Technology (Guangzhou)</span>
            <span class="author-block"><sup>2</sup>Sun Yat-sen University</span>
            <span class="author-block"><sup>3</sup>The Hong Kong University of Science and Technology</span>
          </div>

          
          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/2505.11247"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- <span class="link-block">
                <a href="https://youtu.be/2impj0nFhdM"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- <span class="link-block">
                <a href="https://github.com/zack4417/OACP"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                </a>
              </span> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
Ensuring the safety and robustness of autonomous driving systems necessitates a comprehensive evaluation in safety-critical scenarios. 
However, these safety-critical scenarios are rare and difficult to collect from real-world driving data, posing significant challenges to effectively assessing the performance of autonomous vehicles. Typical existing methods often suffer from limited controllability and lack user-friendliness, as extensive expert knowledge is essentially required. 
To address these challenges, we propose LD-Scene, a novel framework that integrates Large Language Models (LLMs) with Latent Diffusion Models (LDMs) for user-controllable adversarial scenario generation through natural language.
Our approach comprises an LDM that captures realistic driving trajectory distributions and an LLM-based guidance module that translates user queries into adversarial guidance functions, facilitating the generation of scenarios aligned with user queries. 
The guidance module integrates an LLM-based Chain-of-Thought (CoT) code generator and an LLM-based code debugger, enhancing the controllability and robustness in generating guidance functions. 
Extensive experiments conducted on the nuScenes dataset demonstrate that LD-Scene achieves state-of-the-art performance in generating realistic and effective adversarial scenarios. Furthermore, our framework provides fine-grained control over adversarial behaviors, thereby facilitating more effective testing tailored to specific driving scenarios.          </p>
        </div>
      </div>
    </div>
  </div>
</section>
 
<section class="section">
  <div class="container is-max-desktop">

    <!-- Model Overview Section -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">Model Overview</h2>
        <div class="content has-text-justified">          
          <figure class="has-text-centered">
            <img
              src="figs/overview.png"
              alt="Overall framework of LD-Scene"
              style="max-width: 100%; height: auto;"
            >
            <figcaption class="has-text-grey is-size-6">
    Overall framework of LD-Scene. During the training stage, an LDM learns the distribution of realistic driving trajectories conditioned on the latent representation of historical scene input. During the inference stage, given a user query, an LLM-based code generator produces an adversarial loss function. This loss function is then validated by an LLM-based debugger through a closed-loop unit testing process and subsequently used to guide the diffusion model in generating safety-critical driving scenarios.
            </figcaption>
          </figure>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Safety-Critical Traffic Simulation Section -->
    <div class="column">
      <div class="content">
        <h2 class="title is-3">Safety-Critical Traffic Simulation</h2>
        <div class="content has-text-justified">
          <div class="columns is-centered">
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/example/1_10.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                The ego vehicle faces a critical decision while merging at a ramp.
              </p>
            </div>
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/example/2_116.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                The ego vehicle encounters a critical situation as a static vehicle suddenly starts moving, requiring the ego vehicle to brake in time.
              </p>
            </div>
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/example/0_123.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                The ego vehicle encounters a safety-critical interaction with another vehicle at an intersection.
              </p>
            </div>
          </div>

          <div class="columns is-centered">
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/example/0_141.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                The ego vehicle encounters a safety-critical simulation as the leading vehicle suddenly brakes, requiring the ego vehicle to avoid a rear-end collision.
              </p>
            </div>
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/example/3_120.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                The ego vehicle encounters a safety-critical scenario involving a sudden cut-in by an adjacent vehicle.
              </p>
            </div>
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/example/6_25.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                The ego vehicle encounters a challenging scenario with an oncoming vehicle driving against traffic, requiring a prompt response.
              </p>
            </div>
          </div>

          <div class="columns columns is-vcentered">
            <div class="column is-two-thirds">
              <!-- Performance Evaluation Table -->
              <div class="box mt-6">
                <h3 class="title is-5 has-text-centered">Overall performance comparison of baseline models on the nuScenes dataset</h3>
                <div class="table-container" style="font-size: 0.81rem;">
                  <table class="table is-bordered is-striped is-fullwidth">
                    <thead>
                      <tr>
                        <th rowspan="2">Method</th>
                        <th colspan="2" class="has-text-centered">Adversariality</th>
                        <th colspan="5" class="has-text-centered">Behavior Plausibility</th>
                        <th colspan="1" class="has-text-centered">Efficiency</th>
                      </tr>
                      <tr>
                        <th>Adv-Ego Coll.</th>
                        <th>Adv Acc.</th>
                        <th>Adv Offroad</th>
                        <th>Other Offroad</th>
                        <th>Adv-Other Coll.</th>
                        <th>Other-Ego Coll.</th>
                        <th>Other-Other Coll.</th>
                        <th>Sim Time</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>AdvSim</td>
                        <td>24.72</td>
                        <td>0.90</td>
                        <td>15.60</td>
                        <td><strong>14.85</strong></td>
                        <td><strong>0.56</strong></td>
                        <td><strong>0.91</strong></td>
                        <td>0.11</td>
                        <td>338.35</td>
                      </tr>
                      <tr>
                        <td>Strive</td>
                        <td>22.69</td>
                        <td>0.88</td>
                        <td>18.94</td>
                        <td>16.64</td>
                        <td>0.90</td>
                        <td>1.08</td>
                        <td><strong>0.05</strong></td>
                        <td>609.72</td>
                      </tr>
                      <tr>
                        <td>DiffScene</td>
                        <td>15.06</td>
                        <td>0.98</td>
                        <td>19.71</td>
                        <td>19.65</td>
                        <td>8.03</td>
                        <td>2.60</td>
                        <td>1.67</td>
                        <td>199.01</td>
                      </tr>
                      <tr>
                        <td>Safe-Sim</td>
                        <td>27.81</td>
                        <td>1.09</td>
                        <td>21.79</td>
                        <td>18.12</td>
                        <td>7.52</td>
                        <td>3.21</td>
                        <td>0.66</td>
                        <td><strong>193.59</strong></td>
                      </tr>
                      <tr>
                        <td><strong>LD-Scene</strong></td>
                        <td><strong>40.75</strong></td>
                        <td><strong>1.36</strong></td>
                        <td><strong>12.52</strong></td>
                        <td>17.95</td>
                        <td>4.93</td>
                        <td>2.17</td>
                        <td>0.66</td>
                        <td>229.40</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="column is-one-thirds" style="padding-left: 0; padding-top: 30px;">
              <figure class="has-text-centered" style="margin-left: 0; margin-top: 30px;">
                <img
                  src="figs/comparison.png"
                  alt="Model Comparison on Adversariality, Behavior Plausibility, and Efficiency"
                  style="max-width: 110%; height: auto;"
                >
              </figure>
            </div>
          </div>
          <p class="is-italic has-text-centered mt-2">
            This balanced performance confirms that LD-Scene achieves the strongest adversarial effectiveness while maintaining high levels of realism and generation efficiency, thus demonstrating its superiority across all evaluation metrics.
          </p>
        </div>
      </div>
    </div>

    <!-- Controllable Adversarial Behavior Section -->
    <div class="column">
      <div class="content">
        <h2 class="title is-3">Controllable Adversarial Behavior</h2>
        <div class="content has-text-justified">          
          <div class="columns is-centered">
            <div class="column">
              <video class="video-player" autoplay muted loop playsinline>
                <source src="videos//controllable/controllable_example.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                Case studies on adversarial safety-critical scenario generation based on different user queries, including normal collisions, high-speed overtaking collisions, and sharp-turn collisions. The results demonstrate the capability of our LD-Scene for controllable adversarial behavior, enabling the generation of diverse safety-critical scenarios.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Failure Cases Section -->
    <div class="column">
      <div class="content">
        <h2 class="title is-3">Failure Cases</h2>
        <div class="content has-text-justified">          
          <div class="columns is-centered">
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/failure/3_79.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                Collision with non-ego vehicle.
              </p>
            </div>
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/failure/1_90.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                Rear-end collision with the ego vehicle.
              </p>
            </div>
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/failure/4_16.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                Head-on collision with the ego vehicle.
              </p>
            </div>
            <div class="column">
              <video class="video-player-s" autoplay muted loop playsinline>
                <source src="videos/failure/1_84.mp4" type="video/mp4">
              </video>
              <p class="has-text-centered is-italic mt-2">
                Unreasonable selection of adversarial vehicle.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{peng2025ld,
  title={LD-Scene: LLM-Guided Diffusion for Controllable Generation of Adversarial Safety-Critical Driving Scenarios},
  author={Peng, Mingxing and Xie, Yuting and Guo, Xusen and Yao, Ruoyu and Yang, Hai and Ma, Jun},
  journal={arXiv preprint arXiv:2505.11247},
  year={2025}
}</code></pre>
  </div>
</section> 

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <p>
        This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
      </p>
    </div>
  </div>
</footer>

</body>
</html>